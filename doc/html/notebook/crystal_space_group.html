<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>crystal_space_group - Methodology and code &#8212; iprPy 0.11.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=2a422f08" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=a2f1e6c4"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="diatom_scan - Methodology and code" href="diatom_scan.html" />
    <link rel="prev" title="bond_angle_scan - Methodology and code" href="bond_angle_scan.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="diatom_scan.html" title="diatom_scan - Methodology and code"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bond_angle_scan.html" title="bond_angle_scan - Methodology and code"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../notebook_styles.html" accesskey="U">Jupyter Demonstration Notebooks</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">crystal_space_group - Methodology and code</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="crystal_space_group---Methodology-and-code">
<h1>crystal_space_group - Methodology and code<a class="headerlink" href="#crystal_space_group---Methodology-and-code" title="Permalink to this heading">¶</a></h1>
<p><strong>Python imports</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.numpy.org/">numpy</a></p></li>
<li><p><a class="reference external" href="https://ipython.org">IPython</a></p></li>
<li><p><a class="reference external" href="https://github.com/usnistgov/atomman">atomman</a></p></li>
<li><p><a class="reference external" href="https://github.com/usnistgov/iprPy">iprPy</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard library imports</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://atztogo.github.io/spglib/python-spglib.html</span>
<span class="kn">import</span> <span class="nn">spglib</span>

<span class="c1"># https://ipython.org/</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.lammps</span> <span class="k">as</span> <span class="nn">lmp</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>
<span class="kn">from</span> <span class="nn">atomman.tools</span> <span class="kn">import</span> <span class="n">filltemplate</span>

<span class="c1"># https://github.com/usnistgov/iprPy</span>
<span class="kn">import</span> <span class="nn">iprPy</span>
<span class="kn">from</span> <span class="nn">iprPy.tools</span> <span class="kn">import</span> <span class="n">read_calc_file</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook last executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="s1">&#39;using iprPy version&#39;</span><span class="p">,</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Notebook last executed on 2023-07-31 using iprPy version 0.11.6
</pre></div></div>
</div>
<section id="1.-Load-calculation-and-view-description">
<h2>1. Load calculation and view description<a class="headerlink" href="#1.-Load-calculation-and-view-description" title="Permalink to this heading">¶</a></h2>
<section id="1.1.-Load-the-calculation">
<h3>1.1. Load the calculation<a class="headerlink" href="#1.1.-Load-the-calculation" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the calculation being demoed</span>
<span class="n">calculation</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">load_calculation</span><span class="p">(</span><span class="s1">&#39;crystal_space_group&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1.2.-Display-calculation-description-and-theory">
<h3>1.2. Display calculation description and theory<a class="headerlink" href="#1.2.-Display-calculation-description-and-theory" title="Permalink to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display main docs and theory</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">calculation</span><span class="o">.</span><span class="n">maindoc</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">calculation</span><span class="o">.</span><span class="n">theorydoc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="crystal_space_group-calculation-style">
<h4>crystal_space_group calculation style<a class="headerlink" href="#crystal_space_group-calculation-style" title="Permalink to this heading">¶</a></h4>
<p><strong>Lucas M. Hale</strong>, <a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>, <em>Materials Science and Engineering Division, NIST</em>.</p>
<section id="Introduction">
<h5>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">¶</a></h5>
<p>The crystal_space_group calculation style characterizes a bulk atomic system (configuration) by determining its space group by evaluating symmetry elements of the box dimensions and atomic position. This is useful for analyzing relaxed systems to determine if they have transformed to a different crystal structure. An ideal unit cell based on the identified space group and the system’s box dimensions is also generated.</p>
<section id="Version-notes">
<h6>Version notes<a class="headerlink" href="#Version-notes" title="Permalink to this heading">¶</a></h6>
<ul class="simple">
<li><p>2018-07-09: Notebook added.</p></li>
<li><p>2019-07-30: Function slightly updated</p></li>
<li><p>2020-09-22: Setup and parameter definition streamlined. Method and theory expanded.</p></li>
<li><p>2022-03-11: Notebook updated to reflect version 0.11.</p></li>
</ul>
</section>
<section id="Additional-dependencies">
<h6>Additional dependencies<a class="headerlink" href="#Additional-dependencies" title="Permalink to this heading">¶</a></h6>
<ul class="simple">
<li><p><a class="reference external" href="https://atztogo.github.io/spglib/python-spglib.html">spglib</a></p></li>
</ul>
</section>
<section id="Disclaimers">
<h6>Disclaimers<a class="headerlink" href="#Disclaimers" title="Permalink to this heading">¶</a></h6>
<ul class="simple">
<li><p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">NIST disclaimers</a></p></li>
<li><p>The results are sensitive to the symmetryprecision parameter as it defines the tolerance for identifying which atomic positions and box dimensions are symmetrically equivalent. A small symmetryprecision value may be able to differentiate between ideal and distorted crystals, but it will cause the calculation to fail if smaller than the variability in the associated system properties.</p></li>
</ul>
</section>
</section>
</section>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Method-and-Theory">
<h4>Method and Theory<a class="headerlink" href="#Method-and-Theory" title="Permalink to this heading">¶</a></h4>
<p>The calculation relies on the spglib Python package, which itself is a wrapper around the spglib library. The library analyzes an atomic configuration to determine symmetry elements within a precision tolerance for the atomic positions and the box dimensions. It also contains a database of information related to the different space groups.</p>
<p>More information can be found at the <a class="reference external" href="https://atztogo.github.io/spglib/">spglib homepage</a>.</p>
</section>
</div>
</div>
</section>
</section>
<section id="2.-Define-calculation-functions-and-generate-files">
<h2>2. Define calculation functions and generate files<a class="headerlink" href="#2.-Define-calculation-functions-and-generate-files" title="Permalink to this heading">¶</a></h2>
<p>This section defines the calculation functions and associated resource files exactly as they exist inside the iprPy package. This allows for the code used to be directly visible and modifiable by anyone looking to see how it works.</p>
<section id="2.1.-crystal_space_group()">
<h3>2.1. crystal_space_group()<a class="headerlink" href="#2.1.-crystal_space_group()" title="Permalink to this heading">¶</a></h3>
<p>This is the primary function for the calculation. The version of this function built in iprPy can be accessed by calling the calc() method of an object of the associated calculation class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coding: utf-8</span>

<span class="c1"># Python script created by Lucas Hale</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://atztogo.github.io/spglib/python-spglib.html</span>
<span class="kn">import</span> <span class="nn">spglib</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>

<span class="k">def</span> <span class="nf">crystal_space_group</span><span class="p">(</span><span class="n">system</span><span class="p">:</span> <span class="n">am</span><span class="o">.</span><span class="n">System</span><span class="p">,</span>
                        <span class="n">symprec</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
                        <span class="n">to_primitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">no_idealize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses spglib to evaluate space group information for a given system.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    system : atomman.System</span>
<span class="sd">        The system to analyze.</span>
<span class="sd">    symprec : float, optional</span>
<span class="sd">        Absolute length tolerance to use in identifying symmetry of atomic</span>
<span class="sd">        sites and system boundaries. Default value is 1e-5</span>
<span class="sd">    to_primitive : bool, optional</span>
<span class="sd">        Indicates if the returned unit cell is conventional (False) or</span>
<span class="sd">        primitive (True). Default value is False.</span>
<span class="sd">    no_idealize : bool, optional</span>
<span class="sd">        Indicates if the atom positions in the returned unit cell are averaged</span>
<span class="sd">        (True) or idealized based on the structure (False).  Default value is</span>
<span class="sd">        False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary of results consisting of keys:</span>

<span class="sd">        - **&#39;number&#39;** (*int*) The spacegroup number.</span>
<span class="sd">        - **&#39;international_short&#39;** (*str*) The short international spacegroup</span>
<span class="sd">          symbol.</span>
<span class="sd">        - **&#39;international_full&#39;** (*str*) The full international spacegroup</span>
<span class="sd">          symbol.</span>
<span class="sd">        - **&#39;international&#39;** (*str*) The international spacegroup symbol.</span>
<span class="sd">        - **&#39;schoenflies&#39;** (*str*) The schoenflies spacegroup symbol.</span>
<span class="sd">        - **&#39;hall_symbol&#39;** (*str*) The Hall symbol.</span>
<span class="sd">        - **&#39;choice&#39;** (*str*) The setting choice if there is one.</span>
<span class="sd">        - **&#39;pointgroup_international&#39;** (*str*) The international pointgroup</span>
<span class="sd">          symbol.</span>
<span class="sd">        - **&#39;pointgroup_schoenflies&#39;** (*str*) The schoenflies pointgroup</span>
<span class="sd">          symbol.</span>
<span class="sd">        - **&#39;arithmetic_crystal_class_number&#39;** (*int*) The arithmetic crystal</span>
<span class="sd">          class number.</span>
<span class="sd">        - **&#39;arithmetic_crystal_class_symbol&#39;** (*str*) The arithmetic crystal</span>
<span class="sd">          class symbol.</span>
<span class="sd">        - **&#39;ucell&#39;** (*am.System*) The spacegroup-processed unit cell.</span>
<span class="sd">        - **&#39;hall_number&#39;** (*int*) The Hall number.</span>
<span class="sd">        - **&#39;wyckoffs&#39;** (*list*) A list of the spacegroup&#39;s Wyckoff symbols</span>
<span class="sd">          where atoms are found.</span>
<span class="sd">        - **&#39;equivalent_atoms&#39;** (*list*) A list of indices indicating which</span>
<span class="sd">          atoms are equivalent to others.</span>
<span class="sd">        - **&#39;pearson&#39;** (*str*) The Pearson symbol.</span>
<span class="sd">        - **&#39;wyckoff_fingerprint&#39;** (*str*) The Wyckoff symbols joined</span>
<span class="sd">          together.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Identify the standardized unit cell representation</span>
    <span class="n">sym_data</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">get_symmetry_dataset</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;spglib_cell&#39;</span><span class="p">),</span> <span class="n">symprec</span><span class="o">=</span><span class="n">symprec</span><span class="p">)</span>
    <span class="n">ucell</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">standardize_cell</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;spglib_cell&#39;</span><span class="p">),</span>
                                    <span class="n">to_primitive</span><span class="o">=</span><span class="n">to_primitive</span><span class="p">,</span>
                                    <span class="n">no_idealize</span><span class="o">=</span><span class="n">no_idealize</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="n">symprec</span><span class="p">)</span>

    <span class="c1"># Convert back to atomman systems and normalize</span>
    <span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;spglib_cell&#39;</span><span class="p">,</span> <span class="n">ucell</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">system</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
    <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span> <span class="o">-=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ucell</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

    <span class="c1"># Throw error if natoms &gt; 2000</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">natoms</span>
    <span class="k">if</span> <span class="n">natoms</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;too many positions&#39;</span><span class="p">)</span>

    <span class="c1"># Average extra per-atom properties by mappings to primitive</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;mapping_to_primitive&#39;</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">prop</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;atype&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">view</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;mapping_to_primitive&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">prop</span><span class="p">():</span>
                <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">view</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">view</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;std_mapping_to_primitive&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Get space group metadata</span>
    <span class="n">sym_data</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">get_symmetry_dataset</span><span class="p">(</span><span class="n">ucell</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;spglib_cell&#39;</span><span class="p">))</span>
    <span class="n">spg_type</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">get_spacegroup_type</span><span class="p">(</span><span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;hall_number&#39;</span><span class="p">])</span>

    <span class="c1"># Generate Pearson symbol</span>
    <span class="k">if</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
    <span class="k">elif</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
    <span class="k">elif</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">74</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
    <span class="k">elif</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">142</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
    <span class="k">elif</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">194</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">crystalclass</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>

    <span class="n">latticetype</span> <span class="o">=</span> <span class="n">spg_type</span><span class="p">[</span><span class="s1">&#39;international&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">latticetype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]:</span>
        <span class="n">latticetype</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>

    <span class="n">pearson</span> <span class="o">=</span> <span class="n">crystalclass</span> <span class="o">+</span> <span class="n">latticetype</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">natoms</span><span class="p">)</span>

    <span class="c1"># Generate Wyckoff fingerprint</span>
    <span class="n">fingerprint_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">usites</span><span class="p">,</span> <span class="n">uindices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;equivalent_atoms&#39;</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">usite</span><span class="p">,</span> <span class="n">uindex</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">usites</span><span class="p">,</span> <span class="n">uindices</span><span class="p">):</span>
        <span class="n">atype</span> <span class="o">=</span> <span class="n">ucell</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">atype</span><span class="p">[</span><span class="n">uindex</span><span class="p">]</span>
        <span class="n">wykoff</span> <span class="o">=</span> <span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;wyckoffs&#39;</span><span class="p">][</span><span class="n">uindex</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">atype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fingerprint_dict</span><span class="p">:</span>
            <span class="n">fingerprint_dict</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wykoff</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fingerprint_dict</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wykoff</span><span class="p">)</span>
    <span class="n">fingerprint</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atype</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fingerprint_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">fingerprint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">fingerprint_dict</span><span class="p">[</span><span class="n">atype</span><span class="p">])))</span>
    <span class="n">fingerprint</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fingerprint</span><span class="p">)</span>

    <span class="c1"># Return results</span>
    <span class="n">results_dict</span> <span class="o">=</span> <span class="n">spg_type</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;ucell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ucell</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;hall_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;hall_number&#39;</span><span class="p">]</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;wyckoffs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;wyckoffs&#39;</span><span class="p">]</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;equivalent_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym_data</span><span class="p">[</span><span class="s1">&#39;equivalent_atoms&#39;</span><span class="p">]</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pearson</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;wyckoff_fingerprint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fingerprint</span>

    <span class="k">return</span> <span class="n">results_dict</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="3.-Specify-input-parameters">
<h2>3. Specify input parameters<a class="headerlink" href="#3.-Specify-input-parameters" title="Permalink to this heading">¶</a></h2>
<section id="3.1.-Initial-unit-cell-system">
<h3>3.1. Initial unit cell system<a class="headerlink" href="#3.1.-Initial-unit-cell-system" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>ucell</strong> is an atomman.System representing a fundamental unit cell of the system (required). Here, this is generated using the load parameters and symbols.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ucell by loading prototype record</span>
<span class="n">ucell</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;prototype&#39;</span><span class="p">,</span> <span class="s1">&#39;A1--Cu--fcc&#39;</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Ni&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.52</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ucell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
avect =  [ 3.520,  0.000,  0.000]
bvect =  [ 0.000,  3.520,  0.000]
cvect =  [ 0.000,  0.000,  3.520]
origin = [ 0.000,  0.000,  0.000]
natoms = 4
natypes = 1
symbols = (&#39;Ni&#39;,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   0.000 |   0.000 |   0.000
      1 |       1 |   0.000 |   1.760 |   1.760
      2 |       1 |   1.760 |   0.000 |   1.760
      3 |       1 |   1.760 |   1.760 |   0.000
</pre></div></div>
</div>
</section>
<section id="3.2.-Calculation-specific-parameters">
<h3>3.2. Calculation-specific parameters<a class="headerlink" href="#3.2.-Calculation-specific-parameters" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>symmetryprecision</strong> is a precision tolerance used for the atomic positions and box dimensions for determining symmetry elements. Default value is ‘0.01 angstrom’.</p></li>
<li><p><strong>primitivecell</strong> is a boolean flag indicating if the returned unit cell is to be primitive (True) or conventional (False). Default value is False.</p></li>
<li><p><strong>idealcell</strong> is a boolean flag indicating if the box dimensions and atomic positions are to be idealized based on the space group (True) or averaged based on their actual values (False). Default value is True.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symmetryprecision</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">primitivecell</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">idealcell</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="4.-Run-calculation-and-view-results">
<h2>4. Run calculation and view results<a class="headerlink" href="#4.-Run-calculation-and-view-results" title="Permalink to this heading">¶</a></h2>
<section id="4.1.-Run-calculation">
<h3>4.1. Run calculation<a class="headerlink" href="#4.1.-Run-calculation" title="Permalink to this heading">¶</a></h3>
<p>All primary calculation method functions take a series of inputs and return a dictionary of outputs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span> <span class="o">=</span> <span class="n">crystal_space_group</span><span class="p">(</span><span class="n">ucell</span><span class="p">,</span>
                                   <span class="n">symprec</span><span class="o">=</span><span class="n">symmetryprecision</span><span class="p">,</span>
                                   <span class="n">to_primitive</span><span class="o">=</span><span class="n">primitivecell</span><span class="p">,</span>
                                   <span class="n">no_idealize</span><span class="o">=</span><span class="ow">not</span> <span class="n">idealcell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;number&#39;, &#39;international_short&#39;, &#39;international_full&#39;, &#39;international&#39;, &#39;schoenflies&#39;, &#39;hall_number&#39;, &#39;hall_symbol&#39;, &#39;choice&#39;, &#39;pointgroup_international&#39;, &#39;pointgroup_schoenflies&#39;, &#39;arithmetic_crystal_class_number&#39;, &#39;arithmetic_crystal_class_symbol&#39;, &#39;ucell&#39;, &#39;wyckoffs&#39;, &#39;equivalent_atoms&#39;, &#39;pearson&#39;, &#39;wyckoff_fingerprint&#39;])
</pre></div></div>
</div>
</section>
<section id="4.2.-Report-results">
<h3>4.2. Report results<a class="headerlink" href="#4.2.-Report-results" title="Permalink to this heading">¶</a></h3>
<p>Values returned in the results_dict:</p>
<ul class="simple">
<li><p><strong>‘number’</strong> (<em>int</em>) The spacegroup number.</p></li>
<li><p><strong>‘international_short’</strong> (<em>str</em>) The short international spacegroup symbol.</p></li>
<li><p><strong>‘international_full’</strong> (<em>str</em>) The full international spacegroup symbol.</p></li>
<li><p><strong>‘international’</strong> (<em>str</em>) The international spacegroup symbol.</p></li>
<li><p><strong>‘schoenflies’</strong> (<em>str</em>) The schoenflies spacegroup symbol.</p></li>
<li><p><strong>‘hall_symbol’</strong> (<em>str</em>) The Hall symbol.</p></li>
<li><p><strong>‘choice’</strong> (<em>str</em>) The setting choice if there is one.</p></li>
<li><p><strong>‘pointgroup_international’</strong> (<em>str</em>) The international pointgroup symbol.</p></li>
<li><p><strong>‘pointgroup_schoenflies’</strong> (<em>str</em>) The schoenflies pointgroup symbol.</p></li>
<li><p><strong>‘arithmetic_crystal_class_number’</strong> (<em>int</em>) The arithmetic crystal class number.</p></li>
<li><p><strong>‘arithmetic_crystal_class_symbol’</strong> (<em>str</em>) The arithmetic crystal class symbol.</p></li>
<li><p><strong>‘ucell’</strong> (<em>am.System</em>) The spacegroup-processed unit cell.</p></li>
<li><p><strong>‘hall_number’</strong> (<em>int</em>) The Hall number.</p></li>
<li><p><strong>‘wyckoffs’</strong> (<em>list</em>) A list of the spacegroup’s Wyckoff symbols where atoms are found.</p></li>
<li><p><strong>‘equivalent_atoms’</strong> (<em>list</em>) A list of indices indicating which atoms are equivalent to others.</p></li>
<li><p><strong>‘pearson’</strong> (<em>str</em>) The Pearson symbol.</p></li>
<li><p><strong>‘wyckoff_fingerprint’</strong> (<em>str</em>) The Wyckoff symbols joined together.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">results_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
number
225

international_short
Fm-3m

international_full
F 4/m -3 2/m

international
F m -3 m

schoenflies
Oh^5

hall_number
523

hall_symbol
-F 4 2 3

choice


pointgroup_international
m-3m

pointgroup_schoenflies
Oh

arithmetic_crystal_class_number
72

arithmetic_crystal_class_symbol
m-3mF

ucell
avect =  [ 2.489,  0.000,  0.000]
bvect =  [ 1.245,  2.156,  0.000]
cvect =  [ 1.245,  0.719,  2.032]
origin = [ 0.000,  0.000,  0.000]
natoms = 1
natypes = 1
symbols = (&#39;Ni&#39;,)
pbc = [ True  True  True]
per-atom properties = [&#39;atype&#39;, &#39;pos&#39;]
     id |   atype |  pos[0] |  pos[1] |  pos[2]
      0 |       1 |   0.000 |   0.000 |   0.000

wyckoffs
[&#39;a&#39;]

equivalent_atoms
[0]

pearson
cF1

wyckoff_fingerprint
a

</pre></div></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">crystal_space_group - Methodology and code</a><ul>
<li><a class="reference internal" href="#1.-Load-calculation-and-view-description">1. Load calculation and view description</a><ul>
<li><a class="reference internal" href="#1.1.-Load-the-calculation">1.1. Load the calculation</a></li>
<li><a class="reference internal" href="#1.2.-Display-calculation-description-and-theory">1.2. Display calculation description and theory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Define-calculation-functions-and-generate-files">2. Define calculation functions and generate files</a><ul>
<li><a class="reference internal" href="#2.1.-crystal_space_group()">2.1. crystal_space_group()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Specify-input-parameters">3. Specify input parameters</a><ul>
<li><a class="reference internal" href="#3.1.-Initial-unit-cell-system">3.1. Initial unit cell system</a></li>
<li><a class="reference internal" href="#3.2.-Calculation-specific-parameters">3.2. Calculation-specific parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Run-calculation-and-view-results">4. Run calculation and view results</a><ul>
<li><a class="reference internal" href="#4.1.-Run-calculation">4.1. Run calculation</a></li>
<li><a class="reference internal" href="#4.2.-Report-results">4.2. Report results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="bond_angle_scan.html"
                          title="previous chapter">bond_angle_scan - Methodology and code</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="diatom_scan.html"
                          title="next chapter">diatom_scan - Methodology and code</a></p>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="diatom_scan.html" title="diatom_scan - Methodology and code"
             >next</a> |</li>
        <li class="right" >
          <a href="bond_angle_scan.html" title="bond_angle_scan - Methodology and code"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../notebook_styles.html" >Jupyter Demonstration Notebooks</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">crystal_space_group - Methodology and code</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.1.
    </div>
  </body>
</html>