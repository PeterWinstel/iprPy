<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>bond_angle_scan - Methodology and code &#8212; iprPy 0.11.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=2a422f08" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=a2f1e6c4"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="crystal_space_group - Methodology and code" href="crystal_space_group.html" />
    <link rel="prev" title="E_vs_r_scan - Methodology and code" href="E_vs_r_scan.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="crystal_space_group.html" title="crystal_space_group - Methodology and code"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="E_vs_r_scan.html" title="E_vs_r_scan - Methodology and code"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../notebook_styles.html" accesskey="U">Jupyter Demonstration Notebooks</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">bond_angle_scan - Methodology and code</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="bond_angle_scan---Methodology-and-code">
<h1>bond_angle_scan - Methodology and code<a class="headerlink" href="#bond_angle_scan---Methodology-and-code" title="Permalink to this heading">¶</a></h1>
<p><strong>Python imports</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.numpy.org/">numpy</a></p></li>
<li><p><a class="reference external" href="https://ipython.org">IPython</a></p></li>
<li><p><a class="reference external" href="https://github.com/usnistgov/atomman">atomman</a></p></li>
<li><p><a class="reference external" href="https://github.com/usnistgov/iprPy">iprPy</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard library imports</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="c1"># http://www.numpy.org/</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># https://ipython.org/</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>

<span class="c1"># https://github.com/usnistgov/atomman</span>
<span class="kn">import</span> <span class="nn">atomman</span> <span class="k">as</span> <span class="nn">am</span>
<span class="kn">import</span> <span class="nn">atomman.lammps</span> <span class="k">as</span> <span class="nn">lmp</span>
<span class="kn">import</span> <span class="nn">atomman.unitconvert</span> <span class="k">as</span> <span class="nn">uc</span>
<span class="kn">from</span> <span class="nn">atomman.tools</span> <span class="kn">import</span> <span class="n">filltemplate</span><span class="p">,</span> <span class="n">aslist</span>

<span class="c1"># https://github.com/usnistgov/iprPy</span>
<span class="kn">import</span> <span class="nn">iprPy</span>
<span class="kn">from</span> <span class="nn">iprPy.tools</span> <span class="kn">import</span> <span class="n">read_calc_file</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Notebook last executed on&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="s1">&#39;using iprPy version&#39;</span><span class="p">,</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Notebook last executed on 2023-07-31 using iprPy version 0.11.6
</pre></div></div>
</div>
<section id="1.-Load-calculation-and-view-description">
<h2>1. Load calculation and view description<a class="headerlink" href="#1.-Load-calculation-and-view-description" title="Permalink to this heading">¶</a></h2>
<section id="1.1.-Load-the-calculation">
<h3>1.1. Load the calculation<a class="headerlink" href="#1.1.-Load-the-calculation" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the calculation being demoed</span>
<span class="n">calculation</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">load_calculation</span><span class="p">(</span><span class="s1">&#39;bond_angle_scan&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1.2.-Display-calculation-description-and-theory">
<h3>1.2. Display calculation description and theory<a class="headerlink" href="#1.2.-Display-calculation-description-and-theory" title="Permalink to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display main docs and theory</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">calculation</span><span class="o">.</span><span class="n">maindoc</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">calculation</span><span class="o">.</span><span class="n">theorydoc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="bond_angle_scan-calculation-style">
<h4>bond_angle_scan calculation style<a class="headerlink" href="#bond_angle_scan-calculation-style" title="Permalink to this heading">¶</a></h4>
<p><strong>Lucas M. Hale</strong>, <a class="reference external" href="mailto:lucas&#46;hale&#37;&#52;&#48;nist&#46;gov?Subject=ipr-demo">lucas<span>&#46;</span>hale<span>&#64;</span>nist<span>&#46;</span>gov</a>, <em>Materials Science and Engineering Division, NIST</em>.</p>
<section id="Introduction">
<h5>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">¶</a></h5>
<p>The bond_angle_scan calculation style evaluates the interaction energy between three atoms at varying distances and angles. This provides a means of characterizing the three-body interactions of a given potential. These interactions can provide insight into the bonding predictions for a potential as well as a means of fingerprinting the potentials.</p>
<section id="Version-notes">
<h6>Version notes<a class="headerlink" href="#Version-notes" title="Permalink to this heading">¶</a></h6>
<ul class="simple">
<li><p>2021-04-XX: Calculation added</p></li>
</ul>
</section>
<section id="Additional-dependencies">
<h6>Additional dependencies<a class="headerlink" href="#Additional-dependencies" title="Permalink to this heading">¶</a></h6>
</section>
<section id="Disclaimers">
<h6>Disclaimers<a class="headerlink" href="#Disclaimers" title="Permalink to this heading">¶</a></h6>
<ul class="simple">
<li><p><a class="reference external" href="http://www.nist.gov/public_affairs/disclaimer.cfm">NIST disclaimers</a></p></li>
</ul>
</section>
</section>
</section>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Method-and-Theory">
<h4>Method and Theory<a class="headerlink" href="#Method-and-Theory" title="Permalink to this heading">¶</a></h4>
<p>Three atoms are placed in an otherwise empty system. The relative positions of the atoms are determined by the following three coordinates</p>
<ul class="simple">
<li><p>r_ij is the radial distance between atoms i and j,</p></li>
<li><p>r_ik is the radial distance between atoms i and k, and</p></li>
<li><p>theta_ijk is the angle formed between the i-j and i-k vectors.</p></li>
</ul>
<p>Based on these three bond coordinates, the full positions of the three atoms in the system are determined as follows</p>
<ul class="simple">
<li><p>Atom i is positioned at the system’s origin, [0, 0, 0]</p></li>
<li><p>Atom j is placed r_ij away from atom i along the x coordinate, [r_ij, 0.0, 0.0]</p></li>
<li><p>Atom k is placed in the xy plane based on r_ik and theta_ijk, [r_ik cos(theta_ijk), r_ik sin(theta_ijk), 0.0]</p></li>
</ul>
<p>Values of r_ij, r_ik and theta_ijk are iterated over. The potential energy of the three atoms is evaluated for each configuration corresponding to the different coordinate sets.</p>
</section>
</div>
</div>
</section>
</section>
<section id="2.-Define-calculation-functions-and-generate-files">
<h2>2. Define calculation functions and generate files<a class="headerlink" href="#2.-Define-calculation-functions-and-generate-files" title="Permalink to this heading">¶</a></h2>
<p>This section defines the calculation functions and associated resource files exactly as they exist inside the iprPy package. This allows for the code used to be directly visible and modifiable by anyone looking to see how it works.</p>
<section id="2.1.-bond_angle_scan()">
<h3>2.1. bond_angle_scan()<a class="headerlink" href="#2.1.-bond_angle_scan()" title="Permalink to this heading">¶</a></h3>
<p>This is the primary function for the calculation. The version of this function built in iprPy can be accessed by calling the calc() method of an object of the associated calculation class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bond_angle_scan</span><span class="p">(</span><span class="n">lammps_command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="n">potential</span><span class="p">:</span> <span class="n">am</span><span class="o">.</span><span class="n">lammps</span><span class="o">.</span><span class="n">Potential</span><span class="p">,</span>
                    <span class="n">symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                    <span class="n">mpi_command</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">rmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">),</span>
                    <span class="n">rmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">),</span>
                    <span class="n">rnum</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                    <span class="n">thetamin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">thetamax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span>
                    <span class="n">thetanum</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a three-body bond angle energy scan over a range of interatomic</span>
<span class="sd">    spaces, r, and angles, theta.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lammps_command :str</span>
<span class="sd">        Command for running LAMMPS.</span>
<span class="sd">    potential : atomman.lammps.Potential</span>
<span class="sd">        The LAMMPS implemented potential to use.</span>
<span class="sd">    symbols : list</span>
<span class="sd">        The potential symbols associated with the three atoms in the cluster.</span>
<span class="sd">    mpi_command : str, optional</span>
<span class="sd">        The MPI command for running LAMMPS in parallel.  If not given, LAMMPS</span>
<span class="sd">        will run serially.</span>
<span class="sd">    rmin : float, optional</span>
<span class="sd">        The minimum value for the r_ij and r_ik spacings. Default value is 0.5.</span>
<span class="sd">    rmax : float, optional</span>
<span class="sd">        The maximum value for the r_ij and r_ik spacings. Default value is 5.5.</span>
<span class="sd">    rnum : int, optional</span>
<span class="sd">        The number of r_ij and r_ik spacings to evaluate. Default value is 100.</span>
<span class="sd">    thetamin : float, optional</span>
<span class="sd">        The minimum value for the theta angle. Default value is 1.0.</span>
<span class="sd">    thetamax : float, optional</span>
<span class="sd">        The maximum value for the theta angle. Default value is 180.0.</span>
<span class="sd">    thetanum : int, optional</span>
<span class="sd">        The number of theta angles to evaluate. Default value is 100.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary of results consisting of keys:</span>

<span class="sd">        - **&#39;cluster&#39;** (*atomman.cluster.BondAngleMap*) - Object that maps</span>
<span class="sd">          measured energies to r, theta coordinates, and contains built-in</span>
<span class="sd">          analysis tools.</span>
<span class="sd">        - **results_file&#39;** (*str*) - File name containing the raw energy</span>
<span class="sd">          scan results.</span>
<span class="sd">        - **&#39;length_unit&#39;** (*str*) - Unit of length used in the results_file.</span>
<span class="sd">        - **&#39;energy_unit&#39;** (*str*) - Unit of energy used in the results_file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create cluster object</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">BondAngleMap</span><span class="p">(</span><span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="p">,</span> <span class="n">rnum</span><span class="o">=</span><span class="n">rnum</span><span class="p">,</span>
                                      <span class="n">thetamin</span><span class="o">=</span><span class="n">thetamin</span><span class="p">,</span> <span class="n">thetamax</span><span class="o">=</span><span class="n">thetamax</span><span class="p">,</span>
                                      <span class="n">thetanum</span><span class="o">=</span><span class="n">thetanum</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

    <span class="c1"># Get lammps units</span>
    <span class="n">lammps_units</span> <span class="o">=</span> <span class="n">lmp</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="n">potential</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>

    <span class="c1"># Define lammps variables</span>
    <span class="n">lammps_variables</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Add range parameters</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;rmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;rnum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">get_in_units</span><span class="p">(</span><span class="n">rnum</span><span class="p">,</span> <span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;thetamin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thetamin</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;thetamax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thetamax</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;thetanum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thetanum</span>

    <span class="c1"># Add atomic types</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">natypes</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">atype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">symbols</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">symbols</span><span class="p">,</span> <span class="n">atype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">atype</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">natypes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;natypes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">natypes</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;atype1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atype</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;atype2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atype</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;atype3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atype</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Add potential information</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;atomman_pair_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">pair_info</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;atom_style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">atom_style</span>
    <span class="n">lammps_variables</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potential</span><span class="o">.</span><span class="n">units</span>

    <span class="c1"># Build lammps input script</span>
    <span class="n">lammps_script</span> <span class="o">=</span> <span class="s1">&#39;bond_scan.in&#39;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">read_calc_file</span><span class="p">(</span><span class="s1">&#39;iprPy.calculation.bond_angle_scan&#39;</span><span class="p">,</span> <span class="s1">&#39;bond_scan.template&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lammps_script</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filltemplate</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">lammps_variables</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">))</span>

    <span class="c1"># Run lammps and extract data</span>
    <span class="n">lmp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lammps_command</span><span class="p">,</span> <span class="n">script_name</span><span class="o">=</span><span class="n">lammps_script</span><span class="p">,</span> <span class="n">mpi_command</span><span class="o">=</span><span class="n">mpi_command</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">screen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;3_body_scan.txt&#39;</span><span class="p">,</span> <span class="n">length_unit</span><span class="o">=</span><span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span>
                       <span class="n">energy_unit</span><span class="o">=</span><span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>

    <span class="c1"># Collect results</span>
    <span class="n">results_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cluster</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;results_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3_body_scan.txt&#39;</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;length_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span>
    <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;energy_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lammps_units</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">results_dict</span>
</pre></div>
</div>
</div>
</section>
<section id="2.2.-bond_scan.template-file">
<h3>2.2. bond_scan.template file<a class="headerlink" href="#2.2.-bond_scan.template-file" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;bond_scan.template&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;# LAMMPS input script for exploring the three-body phase space</span>

<span class="s2"># Specify loop ranges</span>
<span class="s2">variable rmin equal &lt;rmin&gt;</span>
<span class="s2">variable rmax equal &lt;rmax&gt;</span>
<span class="s2">variable rnum equal &lt;rnum&gt;</span>
<span class="s2">variable thetamin equal &lt;thetamin&gt;</span>
<span class="s2">variable thetamax equal &lt;thetamax&gt;</span>
<span class="s2">variable thetanum equal &lt;thetanum&gt;</span>

<span class="s2"># Define dummy values for loop indices</span>
<span class="s2">#variable i equal 1</span>
<span class="s2">#variable j equal 1</span>
<span class="s2">#variable k equal 1</span>

<span class="s2"># Define variable atom coordinates</span>
<span class="s2">variable rij equal $</span><span class="si">{rmin}</span><span class="s2">+(v_i-1)*($</span><span class="si">{rmax}</span><span class="s2">-$</span><span class="si">{rmin}</span><span class="s2">)/($</span><span class="si">{rnum}</span><span class="s2">-1)</span>
<span class="s2">variable rik equal $</span><span class="si">{rmin}</span><span class="s2">+(v_j-1)*($</span><span class="si">{rmax}</span><span class="s2">-$</span><span class="si">{rmin}</span><span class="s2">)/($</span><span class="si">{rnum}</span><span class="s2">-1)</span>
<span class="s2">variable theta equal $</span><span class="si">{thetamin}</span><span class="s2">+(v_k-1)*($</span><span class="si">{thetamax}</span><span class="s2">-$</span><span class="si">{thetamin}</span><span class="s2">)/($</span><span class="si">{thetanum}</span><span class="s2">-1)</span>
<span class="s2">variable rtheta equal v_theta*PI/180.0</span>
<span class="s2">variable j_x equal v_rij</span>
<span class="s2">variable k_x equal v_rik*cos(v_rtheta)</span>
<span class="s2">variable k_y equal v_rik*sin(v_rtheta)</span>
<span class="s2">variable energy equal pe</span>

<span class="s2"># Define box bounds based on rmax</span>
<span class="s2">variable rlo equal -3*$</span><span class="si">{rmax}</span>
<span class="s2">variable rhi equal 3*$</span><span class="si">{rmax}</span>

<span class="s2">units &lt;units&gt;</span>

<span class="s2">atom_style &lt;atom_style&gt;</span>

<span class="s2">boundary f f f</span>

<span class="s2">region rbox block $</span><span class="si">{rlo}</span><span class="s2"> $</span><span class="si">{rhi}</span><span class="s2"> $</span><span class="si">{rlo}</span><span class="s2"> $</span><span class="si">{rhi}</span><span class="s2"> -1.0 1.0</span>

<span class="s2">create_box &lt;natypes&gt; rbox</span>

<span class="s2">&lt;atomman_pair_info&gt;</span>

<span class="s2">thermo_style custom step pe</span>
<span class="s2">thermo_modify format float </span><span class="si">%.13e</span>

<span class="s2"># Create atom 1</span>
<span class="s2">create_atoms &lt;atype1&gt; single 0.0 0.0 0.0 units box</span>

<span class="s2"># Start 3_body_scan.txt with header fields</span>
<span class="s2">print &quot;$</span><span class="si">{rmin}</span><span class="s2"> $</span><span class="si">{rmax}</span><span class="s2"> $</span><span class="si">{rnum}</span><span class="s2">&quot; file 3_body_scan.txt screen no</span>
<span class="s2">print &quot;$</span><span class="si">{rmin}</span><span class="s2"> $</span><span class="si">{rmax}</span><span class="s2"> $</span><span class="si">{rnum}</span><span class="s2">&quot; append 3_body_scan.txt screen no</span>
<span class="s2">print &quot;$</span><span class="si">{thetamin}</span><span class="s2"> $</span><span class="si">{thetamax}</span><span class="s2"> $</span><span class="si">{thetanum}</span><span class="s2">&quot; append 3_body_scan.txt screen no</span>

<span class="s2"># Loop i over r_ij values</span>
<span class="s2">variable i loop $</span><span class="si">{rnum}</span>
<span class="s2">    label loopi</span>

<span class="s2">    # Create atom 2</span>
<span class="s2">    create_atoms &lt;atype2&gt; single $</span><span class="si">{j_x}</span><span class="s2"> 0.0 0.0 units box</span>
<span class="s2">    group id2 id 2</span>

<span class="s2">    # Loop j over r_ik values</span>
<span class="s2">    variable j loop $</span><span class="si">{rnum}</span>
<span class="s2">        label loopj</span>

<span class="s2">        # Loop k over theta values</span>
<span class="s2">        variable k loop $</span><span class="si">{thetanum}</span>
<span class="s2">            label loopk</span>

<span class="s2">            # Create atom 3</span>
<span class="s2">            create_atoms &lt;atype3&gt; single $</span><span class="si">{k_x}</span><span class="s2"> $</span><span class="si">{k_y}</span><span class="s2"> 0.0 units box</span>
<span class="s2">            group id3 id 3</span>

<span class="s2">            # Compute energy and output it to 3_body_scan.txt</span>
<span class="s2">            run 0</span>
<span class="s2">            print &quot;$</span><span class="si">{i}</span><span class="s2"> $</span><span class="si">{j}</span><span class="s2"> $</span><span class="si">{k}</span><span class="s2"> $</span><span class="si">{energy}</span><span class="s2">&quot; append 3_body_scan.txt screen no</span>
<span class="s2">            delete_atoms group id3</span>

<span class="s2">            next k</span>
<span class="s2">            jump bond_scan.in loopk</span>

<span class="s2">        next j</span>
<span class="s2">        jump bond_scan.in loopj</span>

<span class="s2">    delete_atoms group id2</span>
<span class="s2">    next i</span>
<span class="s2">    jump bond_scan.in loopi&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="3.-Specify-input-parameters">
<h2>3. Specify input parameters<a class="headerlink" href="#3.-Specify-input-parameters" title="Permalink to this heading">¶</a></h2>
<section id="3.1.-System-specific-paths">
<h3>3.1. System-specific paths<a class="headerlink" href="#3.1.-System-specific-paths" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>lammps_command</strong> is the LAMMPS command to use (required).</p></li>
<li><p><strong>mpi_command</strong> MPI command for running LAMMPS in parallel. A value of None will run simulations serially.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lammps_command</span> <span class="o">=</span> <span class="s1">&#39;lmp&#39;</span>
<span class="n">mpi_command</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Optional: check that LAMMPS works and show its version</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LAMMPS version = </span><span class="si">{</span><span class="n">am</span><span class="o">.</span><span class="n">lammps</span><span class="o">.</span><span class="n">checkversion</span><span class="p">(</span><span class="n">lammps_command</span><span class="p">)[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LAMMPS version = 15 Sep 2022
</pre></div></div>
</div>
</section>
<section id="3.2.-Interatomic-potential">
<h3>3.2. Interatomic potential<a class="headerlink" href="#3.2.-Interatomic-potential" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>potential_name</strong> gives the name of the potential_LAMMPS reference record in the iprPy library to use for the calculation.</p></li>
<li><p><strong>potential</strong> is an atomman.lammps.Potential object (required).</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">potential_name</span> <span class="o">=</span> <span class="s1">&#39;1999--Mishin-Y--Ni--LAMMPS--ipr1&#39;</span>

<span class="c1"># Retrieve potential and parameter file(s) using atomman</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">load_lammps_potential</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">potential_name</span><span class="p">,</span> <span class="n">getfiles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="2.3.-Calculation-specific-parameters">
<h4>2.3. Calculation-specific parameters<a class="headerlink" href="#2.3.-Calculation-specific-parameters" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>symbols</strong> is the element or set of three element model symbols to use for the cluster.</p></li>
<li><p><strong>rmin</strong> is the minimum r_ij and r_ik spacing to use.</p></li>
<li><p><strong>rmax</strong> is the maximum r_ij and r_ik spacing to use.</p></li>
<li><p><strong>rnum</strong> is the number of r_ij and r_ik spacing steps to evaluate.</p></li>
<li><p><strong>thetamin</strong> is the minimum theta angle to use.</p></li>
<li><p><strong>thetamax</strong> is the maximum theta angle to use.</p></li>
<li><p><strong>thetanum</strong> is the number of theta angle steps to evaluate.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symbols</span> <span class="o">=</span> <span class="s1">&#39;Ni&#39;</span>

<span class="n">rmin</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">rmax</span> <span class="o">=</span> <span class="n">uc</span><span class="o">.</span><span class="n">set_in_units</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;angstrom&#39;</span><span class="p">)</span>
<span class="n">rnum</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">thetamin</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">thetamax</span> <span class="o">=</span> <span class="mf">180.0</span>
<span class="n">thetanum</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="4.-Run-calculation-and-view-results">
<h2>4. Run calculation and view results<a class="headerlink" href="#4.-Run-calculation-and-view-results" title="Permalink to this heading">¶</a></h2>
<section id="4.1.-Run-calculation">
<h3>4.1. Run calculation<a class="headerlink" href="#4.1.-Run-calculation" title="Permalink to this heading">¶</a></h3>
<p>All primary calculation method functions take a series of inputs and return a dictionary of outputs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span> <span class="o">=</span> <span class="n">bond_angle_scan</span><span class="p">(</span><span class="n">lammps_command</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">mpi_command</span> <span class="o">=</span> <span class="n">mpi_command</span><span class="p">,</span>
                                <span class="n">rmin</span> <span class="o">=</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span> <span class="o">=</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">rnum</span> <span class="o">=</span> <span class="n">rnum</span><span class="p">,</span>
                                <span class="n">thetamin</span> <span class="o">=</span> <span class="n">thetamin</span><span class="p">,</span> <span class="n">thetamax</span> <span class="o">=</span> <span class="n">thetamax</span><span class="p">,</span> <span class="n">thetanum</span> <span class="o">=</span> <span class="n">thetanum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;cluster&#39;, &#39;results_file&#39;, &#39;length_unit&#39;, &#39;energy_unit&#39;])
</pre></div></div>
</div>
</section>
<section id="4.2.-Report-results">
<h3>4.2. Report results<a class="headerlink" href="#4.2.-Report-results" title="Permalink to this heading">¶</a></h3>
<p>Values returned in the results_dict: - <strong>‘cluster’</strong> (<em>atomman.cluster.BondAngleMap</em>) - An object containing the evaluated energies and their coordinates. Includes built-in methods for analyzing the results. - <strong>‘results_file’</strong> (<em>str</em>) - The name of the file where the measured energies are saved. - <strong>‘length_unit’</strong> (<em>str</em>) - The unit of length used in results_file. - <strong>‘energy_unit’</strong> (<em>str</em>) - The unit of energy used in results_file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results are saved in&#39;</span><span class="p">,</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;results_file&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with lengths in&#39;</span><span class="p">,</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;length_unit&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;and energies in&#39;</span><span class="p">,</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;energy_unit&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Results are saved in 3_body_scan.txt
with lengths in angstrom
and energies in eV
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>

<span class="n">cluster</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r_ij</th>
      <th>r_ik</th>
      <th>r_jk</th>
      <th>theta</th>
      <th>energy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.000349</td>
      <td>1.000000</td>
      <td>9.662228e+02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.003633</td>
      <td>10.421053</td>
      <td>9.644323e+02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.006892</td>
      <td>19.842105</td>
      <td>9.626081e+02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.010104</td>
      <td>29.263158</td>
      <td>9.608158e+02</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.013248</td>
      <td>38.684211</td>
      <td>9.590673e+02</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7995</th>
      <td>6.00</td>
      <td>6.00</td>
      <td>11.356946</td>
      <td>142.315789</td>
      <td>-9.291009e-11</td>
    </tr>
    <tr>
      <th>7996</th>
      <td>6.00</td>
      <td>6.00</td>
      <td>11.636851</td>
      <td>151.736842</td>
      <td>-9.291009e-11</td>
    </tr>
    <tr>
      <th>7997</th>
      <td>6.00</td>
      <td>6.00</td>
      <td>11.838145</td>
      <td>161.157895</td>
      <td>-9.291009e-11</td>
    </tr>
    <tr>
      <th>7998</th>
      <td>6.00</td>
      <td>6.00</td>
      <td>11.959468</td>
      <td>170.578947</td>
      <td>-9.291009e-11</td>
    </tr>
    <tr>
      <th>7999</th>
      <td>6.00</td>
      <td>6.00</td>
      <td>12.000000</td>
      <td>180.000000</td>
      <td>-9.291009e-11</td>
    </tr>
  </tbody>
</table>
<p>8000 rows × 5 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span><span class="o">.</span><span class="n">plot_pdf</span><span class="p">()</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">plot_cumulative_pdf</span><span class="p">()</span>
<span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_bond_angle_scan_24_0.png" src="../_images/notebook_bond_angle_scan_24_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebook_bond_angle_scan_24_1.png" src="../_images/notebook_bond_angle_scan_24_1.png" />
</div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">bond_angle_scan - Methodology and code</a><ul>
<li><a class="reference internal" href="#1.-Load-calculation-and-view-description">1. Load calculation and view description</a><ul>
<li><a class="reference internal" href="#1.1.-Load-the-calculation">1.1. Load the calculation</a></li>
<li><a class="reference internal" href="#1.2.-Display-calculation-description-and-theory">1.2. Display calculation description and theory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Define-calculation-functions-and-generate-files">2. Define calculation functions and generate files</a><ul>
<li><a class="reference internal" href="#2.1.-bond_angle_scan()">2.1. bond_angle_scan()</a></li>
<li><a class="reference internal" href="#2.2.-bond_scan.template-file">2.2. bond_scan.template file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Specify-input-parameters">3. Specify input parameters</a><ul>
<li><a class="reference internal" href="#3.1.-System-specific-paths">3.1. System-specific paths</a></li>
<li><a class="reference internal" href="#3.2.-Interatomic-potential">3.2. Interatomic potential</a><ul>
<li><a class="reference internal" href="#2.3.-Calculation-specific-parameters">2.3. Calculation-specific parameters</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Run-calculation-and-view-results">4. Run calculation and view results</a><ul>
<li><a class="reference internal" href="#4.1.-Run-calculation">4.1. Run calculation</a></li>
<li><a class="reference internal" href="#4.2.-Report-results">4.2. Report results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="E_vs_r_scan.html"
                          title="previous chapter">E_vs_r_scan - Methodology and code</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="crystal_space_group.html"
                          title="next chapter">crystal_space_group - Methodology and code</a></p>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="crystal_space_group.html" title="crystal_space_group - Methodology and code"
             >next</a> |</li>
        <li class="right" >
          <a href="E_vs_r_scan.html" title="E_vs_r_scan - Methodology and code"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../notebook_styles.html" >Jupyter Demonstration Notebooks</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">bond_angle_scan - Methodology and code</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.1.
    </div>
  </body>
</html>