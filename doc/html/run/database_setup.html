<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Database Setup &#8212; iprPy 0.11.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=2a422f08" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=a2f1e6c4"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="High Throughput Operations" href="htp.html" />
    <link rel="prev" title="Run a Jupyter Calculation Notebook" href="notebook.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="htp.html" title="High Throughput Operations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="notebook.html" title="Run a Jupyter Calculation Notebook"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Calculations</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Database Setup</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="database-setup">
<h1>Database Setup<a class="headerlink" href="#database-setup" title="Permalink to this heading">¶</a></h1>
<p>The previous page explained how users can examine and execute individual calculations one at a time to understand how the methods work and how to use them.  However, when running the calculations in that manner, the collecting and managing of the generated results is left up to the user.  Settings in iprPy allow for interactions with one or more databases to be defined that then allow for any generated results to be automatically collected together.  This provides a convenient means of storing the results together in a common format.  Collecting results into a database is also a major benefit when performing high throughput calculations as the vast number of simulations performed almost necessitates some infrastructure to query subsets of the results and perform common analyses methods across similar records.</p>
<section id="basic-settings">
<h2>1. Basic Settings<a class="headerlink" href="#basic-settings" title="Permalink to this heading">¶</a></h2>
<p>Many default settings of how iprPy behaves can be adjusted using the methods of iprPy.settings.  Updates to settings are stored in a local file allowing for future sessions to adhere to the changes that have been made.  Additionally, the same settings file is used by potentials, atomman and iprPy so changes to one will be reflected by the others if the terms are supported by the other packages.</p>
<p>The basic settings terms that can be changed are</p>
<ul class="simple">
<li><p><strong>directory</strong> is the root directory where the settings file is saved to.  The default value is a folder in the user’s home directory.  Most users will likely not want to change this, but doing so is available for edge cases.</p></li>
<li><p><strong>runner_log_directory</strong> is the directory where any logs generated by runners are saved to.  These logs can be useful for debugging as they state the status of all calculations that were performed by each runner.  The default value is a folder named “runner-logs” inside the above directory.</p></li>
</ul>
<section id="command-line">
<h3>1.1. Command line<a class="headerlink" href="#command-line" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>directory
</pre></div>
</div>
<p>will print the current directory that contains the settings file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>set_directory<span class="w"> </span>&lt;path&gt;
</pre></div>
</div>
<p>will change the settings directory to the specified path.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>unset_directory
</pre></div>
</div>
<p>will revert the settings directory back to its default path in the user’s home directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>runner_log_directory
</pre></div>
</div>
<p>will print the current directory where runner log files will be saved.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>set_runner_log_directory<span class="w"> </span>&lt;path&gt;
</pre></div>
</div>
<p>will change the runner log directory to the specified path.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>unset_runner_log_directory
</pre></div>
</div>
<p>will revert the runner log directory back to “runner-logs” inside the settings directory.</p>
</section>
<section id="python">
<h3>1.2. Python<a class="headerlink" href="#python" title="Permalink to this heading">¶</a></h3>
<p>All settings options can be accessed using iprPy.settings. The attributes and method names are consistent with the command line options</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iprPy</span>

<span class="c1"># Check the current settings</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">runner_log_directory</span><span class="p">)</span>

<span class="c1"># Change the directory paths</span>
<span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">set_directory</span><span class="p">(</span><span class="n">NEWPATH1</span><span class="p">)</span>
<span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">set_runner_log_directory</span><span class="p">(</span><span class="n">NEWPATH2</span><span class="p">)</span>

<span class="c1"># Revert the directory paths back to their default values</span>
<span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">unset_directory</span><span class="p">()</span>
<span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">unset_runner_log_directory</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="define-databases">
<h2>2. Define databases<a class="headerlink" href="#define-databases" title="Permalink to this heading">¶</a></h2>
<p>Being able to interact with multiple databases and types of databases is a feature of iprPy that has many benefits</p>
<ul class="simple">
<li><p>The design means that the high throughput operations are not explicitly tied to a single database or database infrastructure.</p></li>
<li><p>Multiple databases makes it possible to separate calculation runs based on specific studies.  This allows for targeted investigations or parameter studies to be performed without polluting a “main” database.</p></li>
<li><p>Simulations can be set up and executed offline using a local database, then the results uploaded to a remote database when finished.</p></li>
<li><p>Accessing databases of different styles makes it possible to use the specific advantages of each unique infrastructure.</p></li>
</ul>
<p>Interactions with databases are managed using Database objects.  Each Database object is initialized by specifying the style of database  and any access terms.  The access settings for any database can be saved to iprPy’s settings allowing for them to be retrieved later using a simple name string.  Saving the database settings in this way also allows for the terminal commands to know which database to interact with.</p>
<p>NOTE: All access settings are stored in the iprPy settings file as unencrypted text.  If your database requires a password to access, only save it to the settings if no one else can access the directory containing the settings file.  If the database requires a password and the password is not set, then a prompt will ask for the password every time a Database object is created.</p>
<section id="database-styles">
<h3>2.1. Database styles<a class="headerlink" href="#database-styles" title="Permalink to this heading">¶</a></h3>
<p>iprPy currently supports the following database styles.  This list could be expanded to support any other database infrastructures that primarily rely on JSON- or XML-like records.</p>
<ul class="simple">
<li><p><strong>local</strong> style databases exist simply as directories on the local machine containing a collection of JSON or XML files and supporting csv cache files.  The advantages of the local style are that it requires no additional setup or installations and the included files can be directly explored in a text editor.  The disadvantages are that there are some performance issues when accessing a record style that contains a large number of entries and the directory has to be directly accessible by the local operating system.</p></li>
<li><p><strong>mongo</strong> style databases interact with MongoDB instances.  The advantages of interacting with a MongoDB database are improved performance and the ability to interact with both local and remote databases.  The disadvantages are that it does require that a MongoDB be set up and accessible and exploring the contained records requires special software or that the records be downloaded.  Individual installs of MongoDB and the supporting software are free and relatively easy, so it is recommended to use a mongo style database if you plan on performing a large number of calculations.</p></li>
<li><p><strong>cdcs</strong> style databases interact with CDCS instances.  The <a class="reference external" href="https://potentials.nist.gov">https://potentials.nist.gov</a> database is a CDCS database and contains records for the content that appears on the NIST Interatomic Potentials Repository as well as input settings parameters used by the iprPy calculations.  The advantages of a CDCS database are that it allows for public access of stored records through either a website or REST APIs with user-access controls and can automatically render stored records using XSLT.  The disadvantages of a CDCS database are that installation is more involved than the other two styles and interactions are slower than MongoDB interactions.</p></li>
</ul>
</section>
<section id="id1">
<h3>2.2. Command line<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>list_databases
</pre></div>
</div>
<p>will display a list of the currently set database names.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>database<span class="w"> </span>&lt;database_name&gt;
</pre></div>
</div>
<p>will display the basic information associated with the database named.  Specifically, the database’s style and host path or url.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>set_database<span class="w"> </span>&lt;database_name&gt;
</pre></div>
</div>
<p>allows for database access parameters to be set and assigned to the given name.  Prompts will ask for the database style and host.  Following that, additional prompts allow for any other access settings to be defined one at a time by first specifying a parameter name and then the value.  The additional prompts will end when no parameter name is given.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>unset_database<span class="w"> </span>&lt;database_name&gt;
</pre></div>
</div>
<p>will delete the saved access settings associated with the database name.  Note that this only removes the saved access settings and does not affect the database itself in any way.</p>
</section>
<section id="id2">
<h3>2.3. Python<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>A database object can be initialized with load_database by giving the database style, host, and any extra database-style-specific access parameters.  Alternatively, load_database can simply take the name of a previously set database and it will create the database object based on the saved settings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newdb</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">load_database</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;/users/me/myDB&#39;</span><span class="p">)</span>
<span class="n">olddb</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">load_database</span><span class="p">(</span><span class="o">&lt;</span><span class="n">database_name</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>The settings operations related to saving database access settings are</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">list_databases</span>
</pre></div>
</div>
<p>returns the list of names associated with saved database settings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">databases</span>
</pre></div>
</div>
<p>returns a dictionary of database access settings where the keys are the database names and the values are dicts that contain the associated access parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">set_database</span><span class="p">(</span><span class="o">&lt;</span><span class="n">database_name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>allows for database access settings to be saved under the given database name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">unset_database</span><span class="p">(</span><span class="o">&lt;</span><span class="n">database_name</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>removes the saved settings associated with the database name.  Note that this only removes the access parameters from the settings file and does not affect the database itself in any way.</p>
</section>
<section id="other-database-information">
<h3>2.4. Other Database information<a class="headerlink" href="#other-database-information" title="Permalink to this heading">¶</a></h3>
<p>The Database objects in iprPy behave slightly differently than the Database objects of the potentials and atomman packages.  This primarily arises from the fact that potentials and atomman predominately access reference data sets while iprPy is designed to generate and manage calculation data.  The main differences can be summed up as</p>
<ul class="simple">
<li><p>A potentials/atomman Database provides a wrapper around two database locations: a local location and a remote location.  By default, the local location is a local-style database and the remote is the CDCS <a class="reference external" href="https://potentials.nist.gov/">https://potentials.nist.gov/</a>.  This provides a convenient means of exploring reference records that could exist either locally or in the official remote database.</p></li>
<li><p>An iprPy Database interacts with a single specified database location that stores both reference inputs and calculation results.</p></li>
<li><p>The iprPy Database objects have a “potdb” attribute and a “build_potdb()” method that return a potentials/atomman Database object where the local database is set to the iprPy’s database location.  This gives each iprPy Database the ability to access the convenience methods of the potentials/atomman Database class.</p></li>
<li><p>The iprPy Databases also contain additional methods associated with managing records for high throughput calculations.</p></li>
</ul>
<p>Related to the potentials/atomman Databases, there are a few extra settings parameters that can be changed and controlled.  All of these have corresponding set methods and the kim parameters also have unset methods.</p>
<ul class="simple">
<li><p><strong>remote</strong> controls the default value of the similarly named parameter used to initialize potentials/atomman Databases and indicates if Database queries will search the remote location.</p></li>
<li><p><strong>local</strong> controls the default value of the similarly named parameter used to initialize potentials/atomman Databases and indicates if Database queries will search the local location.</p></li>
<li><p><strong>pot_dir_style</strong> controls the default value of the similarly named parameter used to initialize potentials/atomman Databases and indicates what the pot_dir values of retrieved LAMMPS potentials are set to.</p></li>
<li><p><strong>kim_api_directory</strong> is used to determine which KIM models are included in any returned queries of LAMMPS potentials.  By default, the query operation will use the kim-api-collections-management script in the specified directory to determine the list of installed KIM models.</p></li>
<li><p><strong>kim_models_file</strong> is used to specify which KIM models are included in any returned queries of LAMMPS potentials.  By default, the query operation will read the list of KIM models from this file.  This is alternate to the kim_api_directory parameter and makes it possible to explore KIM models that may be installed on other resources.</p></li>
</ul>
</section>
</section>
<section id="define-run-directories">
<h2>3. Define run directories<a class="headerlink" href="#define-run-directories" title="Permalink to this heading">¶</a></h2>
<p>A run directory is a local directory used when performing high throughput operations.  Notably, it is where folders related to calculations to be performed are prepared, and then later executed by a runner.</p>
<p>Multiple run directories can be used and it is encouraged allowing for separate pools of calculations that may be associated with different databases or numbers of processors to use.  While there is no inherent links between a database and a run directory, it is recommended as good practice that each run directory be used specifically for a single database.  This is because running the calculations requires that the associated database contains an incomplete record associated with every calculation being performed in the run directory.</p>
<section id="id3">
<h3>3.1. Command line<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>list_run_directories
</pre></div>
</div>
<p>will display a list of the currently set run directory names.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>run_directory<span class="w"> </span>&lt;run_directory_name&gt;
</pre></div>
</div>
<p>will display the path associated with the run directory named.
.. code-block:: bash</p>
<blockquote>
<div><p>$ iprPy set_run_directory &lt;run_directory_name&gt;</p>
</div></blockquote>
<p>allows for a run directory to be set according to the given run directory name.  A prompt will ask for the path to associate with the name.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>iprPy<span class="w"> </span>unset_run_directory<span class="w"> </span>&lt;run_directory_name&gt;
</pre></div>
</div>
<p>will delete the saved settings associated with the run directory name.</p>
</section>
<section id="id4">
<h3>3.2. Python<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_directory</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">load_run_directory</span><span class="p">(</span><span class="o">&lt;</span><span class="n">run_directory_name</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>will retrieve the run directory path associated with the given run directory name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">list_run_directories</span>
</pre></div>
</div>
<p>returns a list of the run directory names that are currently saved to the settings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">run_directories</span>
</pre></div>
</div>
<p>returns a dict where the keys are the saved names of the set run directories and the values are the associated paths.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">set_run_directory</span><span class="p">(</span><span class="o">&lt;</span><span class="n">run_directory_name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>saves a given run directory path under the specified name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iprPy</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">unset_run_directory</span><span class="p">(</span><span class="o">&lt;</span><span class="n">run_directory_name</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>deletes the saved settings associated with the run directory name.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Database Setup</a><ul>
<li><a class="reference internal" href="#basic-settings">1. Basic Settings</a><ul>
<li><a class="reference internal" href="#command-line">1.1. Command line</a></li>
<li><a class="reference internal" href="#python">1.2. Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#define-databases">2. Define databases</a><ul>
<li><a class="reference internal" href="#database-styles">2.1. Database styles</a></li>
<li><a class="reference internal" href="#id1">2.2. Command line</a></li>
<li><a class="reference internal" href="#id2">2.3. Python</a></li>
<li><a class="reference internal" href="#other-database-information">2.4. Other Database information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#define-run-directories">3. Define run directories</a><ul>
<li><a class="reference internal" href="#id3">3.1. Command line</a></li>
<li><a class="reference internal" href="#id4">3.2. Python</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="notebook.html"
                          title="previous chapter">Run a Jupyter Calculation Notebook</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="htp.html"
                          title="next chapter">High Throughput Operations</a></p>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="htp.html" title="High Throughput Operations"
             >next</a> |</li>
        <li class="right" >
          <a href="notebook.html" title="Run a Jupyter Calculation Notebook"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">iprPy 0.11.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Calculations</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Database Setup</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.1.
    </div>
  </body>
</html>